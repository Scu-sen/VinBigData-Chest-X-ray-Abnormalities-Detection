## A Multilabel Classifier for Post Processing

### Pre-processing for Training
<code> python multilabel_preproc.py </code>
- Required input files: `train.csv` from the competition dataset.
- Output: 
    - multilabel_cls_train.csv: A csv file with the training labels
    - multilabel_pos_weight.npy: A npy file with the pos_weights to be used in training.

### Training
<code> python multilabel_train.py </code>
- Required input files: 
    - All training images converted to PNG format stored in a folder specified by the `image_path` variable.
    - `multilabel_cls_train.csv` generated by `multilabel_preproc.py` whose path specified by the `csv_path` variable.
    - `multilabel_pos_weight.npy` generated by `multilabel_preproc.py` whose path specified by the `pos_weight_path` variable.
    
- Output: 5 fold \* 15 models in .pth format saved in the folder specified by the `save_path` variable.

### Inference
<code> python multilabel_inference.py </code>
- Required input files: 
    - All testing images converted to PNG format stored in a folder specified by the `image_path` variable.
    - 5 fold \* 15 models in .pth format saved in the folder specified by the `model_path` variable.
    - `test_meta.csv` from the competition dataset (or simply any csv file with all image_ids)
- Output: 5 prediction CSVs (1 per fold) saved in the folder specified by the `save_path` variable.

### Post-processing and Submission Generation
<code> python postproc.py </code>
- Required input files: 
    - 3 \* 5 multilabel classifier prediction CSVs (1024, 1024_with_fixed_aspect_ratio, 1280_with_fixed_aspect_ratio) whose folder path specified by the `cls_dfs_path` variable.
    - A detector prediction CSV in submission format without any post-processing whose path specified by the `detector_preds_path` variable.
    - specialized predictions for class0 and class10 whose path specified by the `detector_preds_path` variable.
    - A list of image IDs determined based on DICOM metadata which very likely to be "normal" stated in `test_0.139000.csv`.
- Output: A CSV file in submission format saved in the folder specified by the `save_path` variable.
